# ğŸ—ï¸ Architecture U-AUBEN INVENTORY APP

## Vue d'ensemble du SystÃ¨me

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    U-AUBEN INVENTORY APP                         â”‚
â”‚                  (Native Android - Capacitor)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                           â”‚
        â–¼                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FRONTEND     â”‚                          â”‚   BACKEND     â”‚
â”‚  (WebView)    â”‚                          â”‚   (SQLite)    â”‚
â”‚               â”‚                          â”‚               â”‚
â”‚  HTML + CSS   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  @capacitor-  â”‚
â”‚  JavaScript   â”‚      Capacitor Bridge     â”‚  community/   â”‚
â”‚  Tailwind     â”‚                          â”‚  sqlite       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                           â”‚
        â”‚                                           â”‚
        â–¼                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI SCREENS   â”‚                          â”‚  DATABASE     â”‚
â”‚               â”‚                          â”‚               â”‚
â”‚  â€¢ Home       â”‚                          â”‚  â€¢ inventory  â”‚
â”‚  â€¢ Add        â”‚                          â”‚  â€¢ notes      â”‚
â”‚  â€¢ Notes      â”‚                          â”‚               â”‚
â”‚  â€¢ Chat Aube  â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â€¢ Settings   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    IA AUBE (HYBRID)                        â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    ONLINE    â”‚                    â”‚   OFFLINE    â”‚    â”‚
â”‚  â”‚              â”‚                    â”‚              â”‚    â”‚
â”‚  â”‚  Gemini API  â”‚â—„â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Aube Lite   â”‚    â”‚
â”‚  â”‚  + Context   â”‚     â”‚     â”‚        â”‚  (Local)     â”‚    â”‚
â”‚  â”‚  SQLite      â”‚     â”‚     â”‚        â”‚              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                       â”‚     â”‚                             â”‚
â”‚                   â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”                        â”‚
â”‚                   â”‚  DÃ©tection  â”‚                        â”‚
â”‚                   â”‚  Online/    â”‚                        â”‚
â”‚                   â”‚  Offline    â”‚                        â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Flux de DonnÃ©es

### 1. Ajout de Produit

```
User Input
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Formulaire  â”‚
â”‚ (HTML Form) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ onclick="saveProduct()"
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JavaScript Function â”‚
â”‚  saveProduct()      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ await db.run(INSERT...)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Capacitor SQLite   â”‚
â”‚  Plugin             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ SQL Query
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SQLite Database    â”‚
â”‚  u_auben_inventory  â”‚
â”‚                     â”‚
â”‚  Table: inventory   â”‚
â”‚  + new row          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Success
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI Update          â”‚
â”‚  loadInventory()    â”‚
â”‚  â†’ Refresh list     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Conversation avec Aube IA

#### Mode Online

```
User Message: "Combien de Colis A ?"
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ sendMessage()    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1. Get inventory data
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ getInventoryForAI()      â”‚
â”‚ â†’ SELECT * FROM inventoryâ”‚
â”‚ â†’ Format: "Colis A: 25pc"â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 2. Build system prompt
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ System Prompt:                         â”‚
â”‚ "Tu es Aube, assistant IA...           â”‚
â”‚  Inventaire actuel: Colis A: 25 pcs,  â”‚
â”‚                     Colis B: 10 pcs"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 3. Call Gemini API
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ fetch('https://generativelanguage... â”‚
â”‚ googleapis.com/v1beta/models/        â”‚
â”‚ gemini-pro:generateContent')         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 4. Response
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gemini Response:                     â”‚
â”‚ "D'aprÃ¨s l'inventaire, il reste 25   â”‚
â”‚  piÃ¨ces de Colis A."                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 5. Display
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ addChatMessage(response, 'aube')     â”‚
â”‚ â†’ Chat bubble displayed              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Mode Offline

```
User Message: "Stock Colis A ?"
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ sendMessage()    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1. Check connection
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ navigator.onLine     â”‚
â”‚ â†’ false (offline)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 2. Pattern matching
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ processOfflineMode()                â”‚
â”‚                                     â”‚
â”‚ if (msg.includes('stock') ||       â”‚
â”‚     msg.includes('combien'))        â”‚
â”‚   â†’ Query SQL directly              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 3. SQL Query
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SELECT * FROM inventory              â”‚
â”‚ WHERE product_name LIKE '%Colis A%'  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 4. Direct response
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response:                            â”‚
â”‚ "ğŸ”µ Aube (Offline): Il reste 25 pcs  â”‚
â”‚  de Colis A."                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 5. Display
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ addChatMessage(response, 'aube')     â”‚
â”‚ â†’ Chat bubble with ğŸ”µ indicator      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Architecture des Fichiers

```
www/
â”œâ”€â”€ index.html          â† APPLICATION PRINCIPALE
â”‚   â”œâ”€â”€ <head>
â”‚   â”‚   â”œâ”€â”€ CSS Local (tailwind.min.css)
â”‚   â”‚   â”œâ”€â”€ JS Local (lucide, marked)
â”‚   â”‚   â””â”€â”€ Fonts Local
â”‚   â”‚
â”‚   â”œâ”€â”€ <body>
â”‚   â”‚   â”œâ”€â”€ Screens (SPAs)
â”‚   â”‚   â”‚   â”œâ”€â”€ screen-home
â”‚   â”‚   â”‚   â”œâ”€â”€ screen-add-product
â”‚   â”‚   â”‚   â”œâ”€â”€ screen-notes
â”‚   â”‚   â”‚   â”œâ”€â”€ screen-chat-aube
â”‚   â”‚   â”‚   â””â”€â”€ screen-settings
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ Side Menu
â”‚   â”‚
â”‚   â””â”€â”€ <script type="module">
â”‚       â”œâ”€â”€ Import SQLite
â”‚       â”œâ”€â”€ Database Functions
â”‚       â”‚   â”œâ”€â”€ initDatabase()
â”‚       â”‚   â”œâ”€â”€ saveProduct()
â”‚       â”‚   â”œâ”€â”€ loadInventory()
â”‚       â”‚   â”œâ”€â”€ saveNote()
â”‚       â”‚   â””â”€â”€ loadNotes()
â”‚       â”‚
â”‚       â”œâ”€â”€ AI Functions
â”‚       â”‚   â”œâ”€â”€ sendMessage()
â”‚       â”‚   â”œâ”€â”€ getInventoryForAI()
â”‚       â”‚   â”œâ”€â”€ processOnlineMode()
â”‚       â”‚   â””â”€â”€ processOfflineMode()
â”‚       â”‚
â”‚       â””â”€â”€ Navigation Functions
â”‚           â”œâ”€â”€ navigateTo()
â”‚           â”œâ”€â”€ goBack()
â”‚           â””â”€â”€ toggleMenu()
â”‚
â”œâ”€â”€ manifest.json       â† PWA Config
â”œâ”€â”€ tailwind.min.css    â† Downloaded
â”œâ”€â”€ lucide.min.js       â† Downloaded
â”œâ”€â”€ marked.min.js       â† Downloaded
â””â”€â”€ fonts/
    â”œâ”€â”€ inter.css
    â””â”€â”€ *.woff2         â† Downloaded
```

## Cycle de Vie de l'Application

```
1. APP START
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DOMContentLoaded    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ initDatabase()      â”‚
â”‚ â”œâ”€ Create conn      â”‚
â”‚ â”œâ”€ Open DB          â”‚
â”‚ â””â”€ Create tables    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ loadInventory()     â”‚
â”‚ â†’ Display products  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ loadNotes()         â”‚
â”‚ â†’ Display notes     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ checkConnection()   â”‚
â”‚ â†’ Set status        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ lucide.createIcons()â”‚
â”‚ â†’ Render icons      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ APP READY           â”‚
â”‚ User can interact   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. USER INTERACTIONS
   â”‚
   â”œâ”€â–º Add Product â†’ saveProduct() â†’ SQL INSERT â†’ loadInventory()
   â”‚
   â”œâ”€â–º View List â†’ loadInventory() â†’ SQL SELECT â†’ Display
   â”‚
   â”œâ”€â–º Delete â†’ deleteProduct() â†’ SQL DELETE â†’ loadInventory()
   â”‚
   â”œâ”€â–º Chat Aube â†’ sendMessage() â†’ AI Process â†’ addChatMessage()
   â”‚
   â””â”€â–º Export â†’ exportDB() â†’ SQL SELECT ALL â†’ JSON Download

3. BACKGROUND TASKS
   â”‚
   â”œâ”€â–º checkConnection() (every 5s)
   â”‚   â””â”€â–º Update status indicator
   â”‚
   â””â”€â–º Auto-save timestamps
       â””â”€â–º last_updated field
```

## IntÃ©gration SQLite

```
Capacitor SQLite Plugin Architecture
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

JavaScript Layer (index.html)
    â”‚
    â”‚ import { CapacitorSQLite, SQLiteConnection }
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SQLiteConnection                   â”‚
â”‚  â”œâ”€ createConnection()              â”‚
â”‚  â”œâ”€ open()                          â”‚
â”‚  â”œâ”€ execute() â”€â”€â”€â”€â”€â–º CREATE TABLE   â”‚
â”‚  â”œâ”€ run() â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º INSERT/UPDATE  â”‚
â”‚  â””â”€ query() â”€â”€â”€â”€â”€â”€â”€â”€â–º SELECT        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Capacitor Bridge
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Native Android Code                â”‚
â”‚  @capacitor-community/sqlite        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Android SQLite API
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SQLite Database File               â”‚
â”‚  /data/data/com.uauben.inventory/   â”‚
â”‚  databases/u_auben_inventory        â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  inventory  â”‚  â”‚   notes     â”‚  â”‚
â”‚  â”‚  table      â”‚  â”‚   table     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## StratÃ©gie Offline-First

```
Asset Loading Strategy
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

BUILD TIME (npm run copy-assets)
    â”‚
    â”œâ”€â–º Download Tailwind CSS â†’ www/tailwind.min.css
    â”œâ”€â–º Download Lucide Icons â†’ www/lucide.min.js
    â”œâ”€â–º Download Marked.js â†’ www/marked.min.js
    â””â”€â–º Download Inter Fonts â†’ www/fonts/*.woff2

RUNTIME
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  index.html loads    â”‚
â”‚  all from www/       â”‚
â”‚  (NO CDN)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  App works 100%      â”‚
â”‚  offline             â”‚
â”‚                      â”‚
â”‚  EXCEPT:             â”‚
â”‚  - Gemini API        â”‚
â”‚    (falls back to    â”‚
â”‚     Aube Lite)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## SÃ©curitÃ© et Performance

```
Security Layers
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. SQL Injection Protection
   â”œâ”€ Prepared statements (? placeholders)
   â”œâ”€ No string concatenation
   â””â”€ Input validation

2. Local Storage Only
   â”œâ”€ Data stays on device
   â”œâ”€ No cloud sync (by design)
   â””â”€ User controls export

3. API Key Security
   â”œâ”€ Stored in localStorage
   â”œâ”€ Not transmitted except to Gemini
   â””â”€ User can delete anytime

Performance Optimizations
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. SQLite
   â”œâ”€ Indexed primary keys
   â”œâ”€ Efficient queries (no SELECT *)
   â””â”€ Transactions for bulk ops

2. UI
   â”œâ”€ Single-page app (no reloads)
   â”œâ”€ Lazy icon rendering
   â””â”€ Smooth navigation

3. Assets
   â”œâ”€ Local files (no network)
   â”œâ”€ Compressed CSS/JS
   â””â”€ Optimized fonts
```

## Ã‰tat de l'Application

```
Global State Management
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  In-Memory Variables            â”‚
â”‚                                 â”‚
â”‚  â€¢ currentScreen                â”‚
â”‚  â€¢ navigationHistory            â”‚
â”‚  â€¢ chatHistory                  â”‚
â”‚  â€¢ db (SQLite connection)       â”‚
â”‚  â€¢ sqliteConnection             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Persistent Storage             â”‚
â”‚                                 â”‚
â”‚  â€¢ SQLite DB (inventory, notes) â”‚
â”‚  â€¢ localStorage (API key)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI State                       â”‚
â”‚                                 â”‚
â”‚  â€¢ Active screen visibility     â”‚
â”‚  â€¢ Form inputs                  â”‚
â”‚  â€¢ Chat messages                â”‚
â”‚  â€¢ Connection indicator         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Conclusion

Cette architecture garantit :

âœ… **Autonomie complÃ¨te** : Fonctionne 100% offline
âœ… **Performance** : SQLite ultra-rapide, assets locaux
âœ… **Intelligence** : IA hybride online/offline
âœ… **FiabilitÃ©** : Pas de dÃ©pendance externe critique
âœ… **SimplicitÃ©** : Un seul fichier HTML principal
âœ… **Ã‰volutivitÃ©** : Facile Ã  Ã©tendre (nouvelles tables, fonctionnalitÃ©s)

---

**Architecture validÃ©e selon les spÃ©cifications U-AUBEN** âœ…
